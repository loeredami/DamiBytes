Split up functions to more files. (See machine.go on why the hell this is absolutely necessary in the future.)